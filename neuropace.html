<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NeuroPace Financial Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="charts.js"></script>
  <style>
    body {
      background-image: url('https://via.placeholder.com/1920x1080.png?text=Gold+Glossy+Background');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
    }
  </style>
</head>
<body class="min-h-screen bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200 p-4 max-w-7xl mx-auto" onload="initializeNeuroPaceCharts()">
  <!-- Dashboard Header -->
  <header class="mb-8">
    <div class="flex flex-col md:flex-row justify-between items-start md:items-center">
      <div>
        <h1 class="text-xl sm:text-2xl md:text-3xl font-bold">NeuroPace, Inc. - Epilepsy Neuromodulation Dashboard</h1>
        <p class="text-gray-600 dark:text-gray-400 mt-1 text-sm sm:text-base">Comprehensive analysis of RNS System data (2018-2024)</p>
      </div>
      <div class="mt-4 md:mt-0 flex items-center space-x-4">
        <button id="darkModeToggle" class="px-4 py-2 bg-gray-200 dark:bg-gray-700 rounded-md text-gray-800 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600 transition">
          <span class="dark:hidden">üåô Dark Mode</span>
          <span class="hidden dark:inline">‚òÄÔ∏è Light Mode</span>
        </button>
        <p class="text-sm text-gray-500 dark:text-gray-400">Data as of March 4, 2025</p>
      </div>
    </div>
  </header>

  <!-- Key Metrics -->
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6">
      <h3 class="text-sm font-semibold text-gray-500 dark:text-gray-400">Total Revenue (2024)</h3>
      <p class="mt-2 text-3xl font-bold">$79.9M</p>
      <p class="text-sm text-green-600 dark:text-green-400">+22% YoY</p>
      <p class="text-xs text-gray-500 mt-2">Source: <a href="https://investors.neuropace.com/news-and-events/news/news-details/2025/NeuroPace-Reports-Fourth-Quarter-and-Full-Year-2024-Financial-Results/" class="underline text-blue-500 hover:underline" target="_blank">Q4 2024 Report</a></p>
    </div>
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6">
      <h3 class="text-sm font-semibold text-gray-500 dark:text-gray-400">Q4 Revenue (2024)</h3>
      <p class="mt-2 text-3xl font-bold">$21.5M</p>
      <p class="text-sm text-green-600 dark:text-green-400">+19.4% YoY</p>
      <p class="text-xs text-gray-500 mt-2">Source: <a href="https://investors.neuropace.com/news-and-events/news/news-details/2025/NeuroPace-Reports-Fourth-Quarter-and-Full-Year-2024-Financial-Results/" class="underline text-blue-500 hover:underline" target="_blank">Q4 2024 Report</a></p>
    </div>
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6">
      <h3 class="text-sm font-semibold text-gray-500 dark:text-gray-400">Gross Margin (2024)</h3>
      <p class="mt-2 text-3xl font-bold">73.6%</p>
      <p class="text-sm text-gray-600 dark:text-gray-300">vs 73.8% in 2023</p>
      <p class="text-xs text-gray-500 mt-2">Source: <a href="https://investors.neuropace.com/news-and-events/news/news-details/2025/NeuroPace-Reports-Fourth-Quarter-and-Full-Year-2024-Financial-Results/" class="underline text-blue-500 hover:underline" target="_blank">Q4 2024 Report</a></p>
    </div>
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6">
      <h3 class="text-sm font-semibold text-gray-500 dark:text-gray-400">2025 Revenue Guidance</h3>
      <p class="mt-2 text-3xl font-bold">$87-91M</p>
      <p class="text-sm text-green-600 dark:text-green-400">+8.9% to +13.9% YoY</p>
      <p class="text-xs text-gray-500 mt-2">Source: <a href="https://investors.neuropace.com/news-and-events/news/news-details/2025/NeuroPace-Reports-Fourth-Quarter-and-Full-Year-2024-Financial-Results/" class="underline text-blue-500 hover:underline" target="_blank">Q4 2024 Report</a></p>
    </div>
  </div>

  <!-- Market Share and Revenue Cards -->
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 mb-8">
    <!-- Market Share Card -->
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 min-h-fit overflow-hidden">
      <h2 class="text-xl sm:text-2xl font-semibold mb-4">Market Share Overview</h2>
      <div class="flex flex-col space-y-6">
        <div class="flex justify-between items-center">
          <span class="text-gray-600 dark:text-gray-400">Current Market Share (2024)</span>
          <span class="text-xl sm:text-2xl font-bold"><a href="https://investors.neuropace.com/#quarterly-results" class="text-blue-500 hover:underline">17.7%</a></span>
        </div>
        <div class="flex justify-between items-center">
          <span class="text-gray-600 dark:text-gray-400">Change Since 2018</span>
          <span class="text-lg sm:text-xl font-bold text-green-600"><a href="https://investors.neuropace.com/#quarterly-results" class="text-blue-500 hover:underline">+78.8%</a></span>
        </div>
        <div>
          <p class="text-sm text-gray-600 dark:text-gray-400 mb-2">Market Share Trend (2018-2024)</p>
          <canvas id="marketShareMiniChart" class="w-full h-32 sm:h-40"></canvas>
        </div>
        <div>
          <p class="text-xs text-gray-500 dark:text-gray-500 mt-2">
            <strong>Note:</strong> Market share estimated as (NeuroPace Revenue / Total Market Size) √ó 100.
          </p>
          <p class="text-xs text-gray-500 dark:text-gray-500 mt-1">
            <strong>Data From:</strong> <a href="https://www.neurotechreports.com/" class="text-blue-500 hover:underline" target="_blank">Neurotech Reports (2018-2019)</a>, <a href="https://investors.neuropace.com/#quarterly-results" class="text-blue-500 hover:underline" target="_blank">NeuroPace Financials (2020-2024)</a>
          </p>
        </div>
      </div>
    </div>

    <!-- Revenue Card -->
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 min-h-fit overflow-hidden">
      <h2 class="text-xl sm:text-2xl font-semibold mb-4">RNS System Revenue</h2>
      <div class="flex flex-col space-y-6">
        <div class="flex justify-between items-center">
          <span class="text-gray-600 dark:text-gray-400">2024 Revenue</span>
          <span class="text-xl sm:text-2xl font-bold"><a href="https://investors.neuropace.com/news-and-events/news/news-details/2025/NeuroPace-Reports-Fourth-Quarter-and-Full-Year-2024-Financial-Results/" class="text-blue-500 hover:underline" target="_blank">$79.9M</a></span>
        </div>
        <div class="flex justify-between items-center">
          <span class="text-gray-600 dark:text-gray-400">Growth Since 2018</span>
          <span class="text-lg sm:text-xl font-bold text-green-600"><a href="https://investors.neuropace.com/#quarterly-results" class="text-blue-500 hover:underline" target="_blank">+166.3%</a></span>
        </div>
        <div>
          <p class="text-sm text-gray-600 dark:text-gray-400 mb-2">Revenue Trend (2018-2024)</p>
          <canvas id="revenueMiniChart" class="w-full h-32 sm:h-40"></canvas>
        </div>
        <div>
          <p class="text-xs text-gray-500 dark:text-gray-500 mt-2">
            <strong>Calculation Method:</strong> Direct revenue from RNS System sales
          </p>
          <p class="text-xs text-gray-500 dark:text-gray-500 mt-1">
            <strong>Data From:</strong> <a href="https://www.neurotechreports.com/" class="text-blue-500 hover:underline" target="_blank">Neurotech Reports (2018-2019)</a>, <a href="https://investors.neuropace.com/news-and-events/news/news-details/2025/NeuroPace-Reports-Fourth-Quarter-and-Full-Year-2024-Financial-Results/" class="text-blue-500 hover:underline" target="_blank">NeuroPace Financials (2020-2024)</a>
          </p>
        </div>
      </div>
    </div>

    <!-- Implant Splits Card -->
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 min-h-fit overflow-hidden">
      <h2 class="text-xl sm:text-2xl font-semibold mb-4">Implant Splits (2021)</h2>
      <div class="flex flex-col space-y-6">
        <div class="flex justify-between items-center">
          <span class="text-gray-600 dark:text-gray-400">Initial Implants</span>
          <span class="text-xl sm:text-2xl font-bold"><a href="https://investors.neuropace.com/news-and-events/news/news-details/2022/NeuroPace-Reports-Fourth-Quarter--Full-Year-2021-Financial-Results/" class="text-blue-500 hover:underline" target="_blank">$33.7M</a></span>
        </div>
        <div class="flex justify-between items-center">
          <span class="text-gray-600 dark:text-gray-400">Replacement Implants</span>
          <span class="text-xl sm:text-2xl font-bold"><a href="https://investors.neuropace.com/news-and-events/news/news-details/2022/NeuroPace-Reports-Fourth-Quarter--Full-Year-2021-Financial-Results/" class="text-blue-500 hover:underline" target="_blank">$11.5M</a></span>
        </div>
        <div>
          <p class="text-sm text-gray-600 dark:text-gray-400 mb-2">Implant Splits (2021)</p>
          <canvas id="implantSplitsChart" class="w-full h-32 sm:h-40"></canvas>
        </div>
        <div>
          <p class="text-xs text-gray-500 dark:text-gray-500 mt-2">
            <strong>Note:</strong> Full implant split data available only for 2021
          </p>
          <p class="text-xs text-gray-500 dark:text-gray-500 mt-1">
            <strong>Data From:</strong> <a href="https://investors.neuropace.com/news-and-events/news/news-details/2022/NeuroPace-Reports-Fourth-Quarter--Full-Year-2021-Financial-Results/" class="text-blue-500 hover:underline" target="_blank">NeuroPace 2021 Financials</a>
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- RNS System Technology -->
  <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6 mb-8">
    <h2 class="text-xl font-semibold mb-6">RNS¬Æ System Technology</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
      <div>
        <div class="flex items-center mb-4">
          <div class="bg-purple-100 dark:bg-purple-900 rounded-lg p-3 mr-4">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-purple-600 dark:text-purple-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
            </svg>
          </div>
          <h3 class="text-lg font-semibold">Responsive Neurostimulation</h3>
        </div>
        <ul class="space-y-2 text-gray-600 dark:text-gray-300">
          <li class="flex items-start">
            <svg class="h-5 w-5 text-purple-500 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
            </svg>
            <span><strong>Target Population:</strong> Patients with drug-resistant focal epilepsy (<a href="https://www.sec.gov/edgar/browse/?CIK=1528287" class="text-blue-500 hover:underline" target="_blank">2024 10-K</a>)</span>
          </li>
          <li class="flex items-start">
            <svg class="h-5 w-5 text-purple-500 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
            </svg>
            <span><strong>Mechanism:</strong> Detects abnormal electrical patterns and delivers stimulation to normalize brain activity (<a href="https://www.neuropace.com/about-rns-system/" class="text-blue-500 hover:underline" target="_blank">NeuroPace</a>)</span>
          </li>
          <li class="flex items-start">
            <svg class="h-5 w-5 text-purple-500 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
            </svg>
            <span><strong>Distribution:</strong> Level 4 Comprehensive Epilepsy Centers (<a href="https://www.sec.gov/edgar/browse/?CIK=1528287" class="text-blue-500 hover:underline" target="_blank">2024 10-K</a>)</span>
          </li>
        </ul>
      </div>
      <div>
        <div class="flex items-center mb-4">
          <div class="bg-blue-100 dark:bg-blue-900 rounded-lg p-3 mr-4">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-600 dark:text-blue-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
            </svg>
          </div>
          <h3 class="text-lg font-semibold">Clinical Evidence</h3>
        </div>
        <ul class="space-y-2 text-gray-600 dark:text-gray-300">
          <li class="flex items-start">
            <svg class="h-5 w-5 text-blue-500 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
            </svg>
            <span><strong>Post-Approval Study:</strong> 82% median reduction in seizure frequency over 3 years (<a href="https://investors.neuropace.com/#quarterly-results" class="text-blue-500 hover:underline" target="_blank">Investor Presentation</a>)</span>
          </li>
          <li class="flex items-start">
            <svg class="h-5 w-5 text-blue-500 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
            </svg>
            <span><strong>Device Longevity:</strong> Average battery life of RNS System ~11 years (<a href="https://www.neuropace.com/patients/faq/" class="text-blue-500 hover:underline" target="_blank">NeuroPace FAQ</a>)</span>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Charts Section -->
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6">
      <h2 class="text-xl font-semibold mb-4">Revenue Trends (2018-2024)</h2>
      <div class="h-80">
        <canvas id="neuropace-revenue-trends"></canvas>
      </div>
      <p class="text-xs text-gray-500 mt-3">Source: <a href="https://www.neurotechreports.com/" class="text-blue-500 hover:underline" target="_blank">Neurotech Reports (2018-2019)</a>, <a href="https://www.sec.gov/edgar/browse/?CIK=1528287" class="text-blue-500 hover:underline" target="_blank">2020‚Äì2023 10-K</a>, <a href="https://investors.neuropace.com/news-and-events/news/news-details/2025/NeuroPace-Reports-Fourth-Quarter-and-Full-Year-2024-Financial-Results/" class="text-blue-500 hover:underline" target="_blank">2024 Q4 Report</a></p>
    </div>
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6">
      <h2 class="text-xl font-semibold mb-4">Q4 Revenue (2021-2024)</h2>
      <div class="h-80">
        <canvas id="neuropace-q4-revenue"></canvas>
      </div>
      <p class="text-xs text-gray-500 mt-3">Source: <a href="https://investors.neuropace.com/news-and-events/news/news-details/2025/NeuroPace-Reports-Fourth-Quarter-and-Full-Year-2024-Financial-Results/" class="text-blue-500 hover:underline" target="_blank">Q4 2024 Report</a></p>
    </div>
  </div>

  <!-- Second Charts Row -->
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6">
      <h2 class="text-xl font-semibold mb-4">Annual Growth Rates</h2>
      <div class="h-80">
        <canvas id="neuropace-growth-metrics"></canvas>
      </div>
      <p class="text-xs text-gray-500 mt-3">Source: <a href="https://www.neurotechreports.com/" class="text-blue-500 hover:underline" target="_blank">Neurotech Reports (2018-2019)</a>, <a href="https://www.sec.gov/edgar/browse/?CIK=1528287" class="text-blue-500 hover:underline" target="_blank">2020‚Äì2023 10-K</a>, <a href="https://investors.neuropace.com/news-and-events/news/news-details/2025/NeuroPace-Reports-Fourth-Quarter-and-Full-Year-2024-Financial-Results/" class="text-blue-500 hover:underline" target="_blank">2024 Q4 Report</a></p>
    </div>
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6">
      <h2 class="text-xl font-semibold mb-4">Financial Metrics</h2>
      <div class="h-80">
        <canvas id="neuropace-financial-metrics"></canvas>
      </div>
      <p class="text-xs text-gray-500 mt-3">Source: <a href="https://investors.neuropace.com/news-and-events/news/news-details/2025/NeuroPace-Reports-Fourth-Quarter-and-Full-Year-2024-Financial-Results/" class="text-blue-500 hover:underline" target="_blank">Q4 2024 Report</a></p>
    </div>
  </div>

  <!-- Implant Breakdown Table and Chart -->
  <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6 mb-8">
    <h2 class="text-xl font-semibold mb-4">Implant Revenue Breakdown (2021-2022)</h2>
    <div class="overflow-x-auto">
      <table class="w-full text-sm text-gray-600 dark:text-gray-300">
        <thead>
          <tr>
            <th class="px-4 py-2">Year</th>
            <th class="px-4 py-2">Period</th>
            <th class="px-4 py-2">Total Revenue ($M)</th>
            <th class="px-4 py-2">Initial Implants ($M)</th>
            <th class="px-4 py-2">Replacement Implants ($M)</th>
            <th class="px-4 py-2">Source</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="px-4 py-2">2022</td>
            <td class="px-4 py-2">Q4</td>
            <td class="px-4 py-2">$12.8</td>
            <td class="px-4 py-2">$9.8 (76.6%)</td>
            <td class="px-4 py-2">$1.4 (10.9%)</td>
            <td class="px-4 py-2"><a href="https://investors.neuropace.com/news-and-events/news/news-details/2023/NeuroPace-Reports-Fourth-Quarter--Full-Year-2022-Financial-Results/" class="text-blue-500 hover:underline" target="_blank">Q4 2022 Report</a></td>
          </tr>
          <tr>
            <td class="px-4 py-2">2022</td>
            <td class="px-4 py-2">Full Year</td>
            <td class="px-4 py-2">$45.5</td>
            <td class="px-4 py-2">$35.7 (78.5%)</td>
            <td class="px-4 py-2">$8.2 (18.0%)</td>
            <td class="px-4 py-2"><a href="https://investors.neuropace.com/news-and-events/news/news-details/2023/NeuroPace-Reports-Fourth-Quarter--Full-Year-2022-Financial-Results/" class="text-blue-500 hover:underline" target="_blank">Q4 2022 Report</a></td>
          </tr>
          <tr>
            <td class="px-4 py-2">2021</td>
            <td class="px-4 py-2">Q4</td>
            <td class="px-4 py-2">$11.0</td>
            <td class="px-4 py-2">$8.5 (77.3%)</td>
            <td class="px-4 py-2">$2.5 (22.7%)</td>
            <td class="px-4 py-2"><a href="https://investors.neuropace.com/news-and-events/news/news-details/2022/NeuroPace-Reports-Fourth-Quarter--Full-Year-2021-Financial-Results/" class="text-blue-500 hover:underline" target="_blank">Q4 2021 Report</a></td>
          </tr>
          <tr>
            <td class="px-4 py-2">2021</td>
            <td class="px-4 py-2">Full Year</td>
            <td class="px-4 py-2">$45.2</td>
            <td class="px-4 py-2">$33.7 (74.6%)</td>
            <td class="px-4 py-2">$11.5 (25.4%)</td>
            <td class="px-4 py-2"><a href="https://investors.neuropace.com/news-and-events/news/news-details/2022/NeuroPace-Reports-Fourth-Quarter--Full-Year-2021-Financial-Results/" class="text-blue-500 hover:underline" target="_blank">Q4 2021 Report</a></td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="h-80 mt-6">
      <canvas id="neuropace-implant-breakdown"></canvas>
    </div>
    <p class="text-xs text-gray-500 mt-3">Sources: <a href="https://investors.neuropace.com/news-and-events/news/news-details/2022/NeuroPace-Reports-Fourth-Quarter--Full-Year-2021-Financial-Results/" class="text-blue-500 hover:underline" target="_blank">2021</a>, <a href="https://investors.neuropace.com/news-and-events/news/news-details/2023/NeuroPace-Reports-Fourth-Quarter--Full-Year-2022-Financial-Results/" class="text-blue-500 hover:underline" target="_blank">2022</a></p>
  </div>

  <!-- Market Position Analysis Card -->
  <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 col-span-1 sm:col-span-2 min-h-fit overflow-hidden mb-8">
    <h2 class="text-xl sm:text-2xl font-semibold mb-4">Market Position Analysis</h2>
    <div class="flex flex-col lg:flex-row gap-8">
      <div class="flex-1">
        <h3 class="font-medium text-lg sm:text-xl mb-3">Market Share by Company (2024)</h3>
        <canvas id="marketSharePieChart" class="w-full h-64 sm:h-72"></canvas>
        <p class="text-xs text-gray-500 mt-3">Source: <a href="https://investors.neuropace.com/#quarterly-results" class="text-blue-500 hover:underline" target="_blank">NeuroPace Financials (2024, estimated)</a></p>
      </div>
      <div class="flex-1">
        <h3 class="font-medium text-lg sm:text-xl mb-3">Gainers & Losers (2018-2024)</h3>
        <div class="space-y-4">
          <div class="bg-red-50 dark:bg-red-900/20 p-4 rounded-md">
            <h4 class="font-semibold text-red-700 dark:text-red-400">Market Share Losers</h4>
            <div class="mt-2">
              <div class="flex justify-between text-sm">
                <span>LivaNova</span>
                <span class="text-red-600 dark:text-red-400"><a href="https://investors.neuropace.com/#quarterly-results" class="text-blue-500 hover:underline" target="_blank">-5.3%</a></span>
              </div>
              <p class="text-xs text-gray-600 dark:text-gray-400 mt-1">
                Market share declined from 85.3% in 2018 to 80.0% in 2024 (estimated).
              </p>
            </div>
          </div>
          <div class="bg-green-50 dark:bg-green-900/20 p-4 rounded-md">
            <h4 class="font-semibold text-green-700 dark:text-green-400">Market Share Gainers</h4>
            <div class="mt-2">
              <div class="flex justify-between text-sm">
                <span>NeuroPace</span>
                <span class="text-green-600 dark:text-green-400"><a href="https://investors.neuropace.com/#quarterly-results" class="text-blue-500 hover:underline" target="_blank">+7.8%</a></span>
              </div>
              <p class="text-xs text-gray-600 dark:text-gray-400 mt-1">
                NeuroPace's market share grew from 9.9% in 2018 to 17.7% in 2024 (estimated).
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Detailed Analytics Card -->
  <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 col-span-1 sm:col-span-2 lg:col-span-3 min-h-fit overflow-hidden mb-8">
    <div class="flex flex-col md:flex-row justify-between items-center mb-6">
      <h2 class="text-xl sm:text-2xl font-semibold">Detailed Analytics</h2>
      <div class="inline-flex mt-3 md:mt-0">
        <select id="chartSelector" class="bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-700 text-gray-800 dark:text-gray-200 rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
          <option value="marketShare">Market Share Trend</option>
          <option value="revenue">Revenue Growth</option>
          <option value="comparison">Comparative Analysis</option>
        </select>
      </div>
    </div>
    <div id="detailedChartContainer" class="w-full h-80 sm:h-96"></div>
    <div class="mt-4 text-sm text-gray-600 dark:text-gray-400">
      <p id="chartDescription" class="mb-2">
        This chart shows NeuroPace's estimated market share trend from 2018 to 2024. The company has grown from 9.9% in 2018 to 17.7% in 2024.
      </p>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
        <div>
          <h3 class="font-medium mb-2">Data Source</h3>
          <p class="text-xs">
            Data from <a href="https://www.neurotechreports.com/" class="text-blue-500 hover:underline" target="_blank">Neurotech Reports (2018-2019)</a> and <a href="https://investors.neuropace.com/#quarterly-results" class="text-blue-500 hover:underline" target="_blank">NeuroPace financial reports (2020-2024)</a>. Market share is estimated based on revenue and market size assumptions.
          </p>
        </div>
        <div>
          <h3 class="font-medium mb-2">Calculation Methodology</h3>
          <p class="text-xs">
            Market share = (NeuroPace Revenue / Estimated Total Market Size) √ó 100. Revenue sourced from financial reports.
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- Clinical Trials Card -->
  <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 col-span-1 sm:col-span-2 lg:col-span-2 min-h-fit overflow-hidden mb-8">
    <h2 class="text-xl sm:text-2xl font-semibold mb-4">Clinical & Regulatory Milestones</h2>
    <div class="overflow-auto max-h-80">
      <div class="border-l-2 border-blue-500 dark:border-blue-400 pl-4">
        <div class="mb-6">
          <div class="flex items-center">
            <div id="clinical-trial-2023" class="bg-blue-500 dark:bg-blue-400 rounded-full w-3 h-3 -ml-5.5"></div>
            <h3 class="text-lg sm:text-xl font-medium ml-3">2023</h3>
          </div>
          <div class="mt-2">
            <h4 class="font-medium text-gray-800 dark:text-gray-200">NAUTILUS Study</h4>
            <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">
              Completed enrollment for generalized epilepsy trial, expanding RNS System indications.
            </p>
            <p class="text-xs text-gray-500 dark:text-gray-500 mt-1">
              <strong>Source:</strong> <a href="https://www.neuropace.com/about-us/news-events/" class="text-blue-500 hover:underline" target="_blank">NeuroPace Press Release</a>
            </p>
          </div>
        </div>
        <div class="mb-6">
          <div class="flex items-center">
            <div class="bg-blue-500 dark:bg-blue-400 rounded-full w-3 h-3 -ml-5.5"></div>
            <h3 class="text-lg sm:text-xl font-medium ml-3">Regulatory Status</h3>
          </div>
          <div class="mt-2">
            <h4 class="font-medium text-gray-800 dark:text-gray-200">RNS System Approval</h4>
            <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">
              FDA-approved for focal epilepsy, with no new approvals reported in 2018-2024.
            </p>
            <p class="text-xs text-gray-500 dark:text-gray-500 mt-1">
              <strong>Source:</strong> <a href="https://www.neuropace.com/our-technology/" class="text-blue-500 hover:underline" target="_blank">NeuroPace Regulatory Information</a>
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Business Details -->
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6">
      <h2 class="text-xl font-semibold mb-4">Sales Growth Drivers</h2>
      <ul class="space-y-3 text-gray-600 dark:text-gray-300">
        <li class="flex items-center">
          <svg class="w-5 h-5 mr-2 text-green-500" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
          </svg>
          <span>Increased adoption at Level 4 CECs (<a href="https://www.sec.gov/edgar/browse/?CIK=1528287" class="text-blue-500 hover:underline" target="_blank">2024 10-K</a>)</span>
        </li>
        <li class="flex items-center">
          <svg class="w-5 h-5 mr-2 text-green-500" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
          </svg>
          <span>Expansion of commercial sales team in 2024 (<a href="https://www.sec.gov/edgar/browse/?CIK=1528287" class="text-blue-500 hover:underline" target="_blank">2024 10-K</a>)</span>
        </li>
        <li class="flex items-center">
          <svg class="w-5 h-5 mr-2 text-green-500" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
          </svg>
          <span>Enhanced clinician education and patient referral programs (<a href="https://www.sec.gov/edgar/browse/?CIK=1528287" class="text-blue-500 hover:underline" target="_blank">2024 10-K</a>)</span>
        </li>
      </ul>
      <div class="mt-6">
        <h3 class="font-medium text-gray-700 dark:text-gray-300 mb-2">Market Opportunity:</h3>
        <p class="text-gray-600 dark:text-gray-400">Patients with drug-resistant focal epilepsy (<a href="https://www.sec.gov/edgar/browse/?CIK=1528287" class="text-blue-500 hover:underline" target="_blank">2024 10-K</a>)</p>
      </div>
      <div class="mt-4">
        <h3 class="font-medium text-gray-700 dark:text-gray-300 mb-2">Quarterly Performance:</h3>
        <div class="text-sm text-gray-600 dark:text-gray-400">
          <p>Q3 2024 Revenue: $19.4M (+13.5% YoY) (<a href="https://investors.neuropace.com/news-and-events/news/news-details/2024/NeuroPace-Reports-Third-Quarter-2024-Financial-Results-and-Provides-Business-Update/" class="text-blue-500 hover:underline" target="_blank">Q3 2024 Report</a>)</p>
          <p>Q1-Q3 2024 Revenue: $58.4M (+18.7% YoY) (<a href="https://investors.neuropace.com/news-and-events/news/news-details/2024/NeuroPace-Reports-Third-Quarter-2024-Financial-Results-and-Provides-Business-Update/" class="text-blue-500 hover:underline" target="_blank">Q3 2024 Report</a>)</p>
        </div>
      </div>
    </div>
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6">
      <h2 class="text-xl font-semibold mb-4">Financial Health</h2>
      <div class="grid grid-cols-2 gap-4">
        <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg">
          <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400">Net Loss</h3>
          <p class="mt-1 text-xl font-semibold">$27.6M</p>
          <p class="text-xs text-green-600">Improved from $33.0M in 2023</p>
          <p class="text-xs text-gray-500">Source: <a href="https://investors.neuropace.com/news-and-events/news/news-details/2025/NeuroPace-Reports-Fourth-Quarter-and-Full-Year-2024-Financial-Results/" class="text-blue-500 hover:underline" target="_blank">Q4 2024 Report</a></p>
        </div>
        <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg">
          <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400">Cash Position</h3>
          <p class="mt-1 text-xl font-semibold">$141.9M</p>
          <p class="text-xs text-gray-500">As of Dec 31, 2024</p>
          <p class="text-xs text-gray-500">Source: <a href="https://investors.neuropace.com/news-and-events/news/news-details/2025/NeuroPace-Reports-Fourth-Quarter-and-Full-Year-2024-Financial-Results/" class="text-blue-500 hover:underline" target="_blank">Q4 2024 Report</a></p>
        </div>
        <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg">
          <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400">Operating Expenses</h3>
          <p class="mt-1 text-xl font-semibold">$80.8M</p>
          <p class="text-xs text-gray-500">2024 Total</p>
          <p class="text-xs text-gray-500">Source: <a href="https://investors.neuropace.com/news-and-events/news/news-details/2025/NeuroPace-Reports-Fourth-Quarter-and-Full-Year-2024-Financial-Results/" class="text-blue-500 hover:underline" target="_blank">Q4 2024 Report</a></p>
        </div>
        <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg">
          <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400">R&D Expenses</h3>
          <p class="mt-1 text-xl font-semibold">$34.8M</p>
          <p class="text-xs text-gray-500">43% of operating expenses</p>
          <p class="text-xs text-gray-500">Source: <a href="https://investors.neuropace.com/news-and-events/news/news-details/2025/NeuroPace-Reports-Fourth-Quarter-and-Full-Year-2024-Financial-Results/" class="text-blue-500 hover:underline" target="_blank">Q4 2024 Report</a></p>
        </div>
      </div>
      <div class="mt-4">
        <h3 class="font-medium text-gray-700 dark:text-gray-300 mb-2">Cash Runway:</h3>
        <div class="bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 p-3 rounded-lg">
          <p class="text-sm text-gray-600 dark:text-gray-400">With $141.9M cash on hand, NeuroPace has runway into 2027 at current operating levels (<a href="https://investors.neuropace.com/news-and-events/news/news-details/2025/NeuroPace-Reports-Fourth-Quarter-and-Full-Year-2024-Financial-Results/" class="text-blue-500 hover:underline" target="_blank">Q4 2024 Report</a>).</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="bg-white dark:bg-gray-800 rounded-lg shadow p-6 mt-8">
    <div class="text-center text-sm text-gray-500 dark:text-gray-400">
      <p><strong>Disclaimer:</strong> Market share estimates are based on NeuroPace revenue divided by estimated total market size, derived from <a href="https://www.neurotechreports.com/" class="text-blue-500 hover:underline" target="_blank">Neurotech Reports (2018-2019)</a>, <a href="https://www.marketresearchfuture.com/" class="text-blue-500 hover:underline" target="_blank">Market Research Future</a>, and <a href="https://investors.neuropace.com/#quarterly-results" class="text-blue-500 hover:underline" target="_blank">NeuroPace financial reports (2020-2024)</a>. Actual market share may vary.</p>
      <p class="mt-2">Data compiled and visualized for informational purposes as of April 24, 2025.</p>
      <p class="mt-2">For the latest updates, visit <a href="https://investors.neuropace.com/" class="text-blue-500 hover:underline" target="_blank">NeuroPace Investor Relations</a>.</p>
    </div>
  </footer>
<script>
    function initializeNeuroPaceCharts() {
  // Data for charts (2018-2024)
  const years = [2018, 2019, 2020, 2021, 2022, 2023, 2024];
  const marketShareData = [9.9, 10.9, 11.7, 12.6, 12.4, 16.0, 17.7]; // NeuroPace market share (%)
  const revenueData = [30.0, 35.0, 41.1, 45.2, 45.5, 65.4, 79.9]; // NeuroPace revenue ($M)
  const growthRateData = [null, 16.7, 17.6, 10.0, 0.7, 43.6, 22.0]; // YoY growth (%)
  const marketShare2024 = { NeuroPace: 17.7, LivaNova: 80.0, Medtronic: 2.3 }; // 2024 market share (%)
  const implantSplitsData = { labels: ['Initial Implants', 'Replacement Implants'], values: [33.7, 11.5] }; // 2021 implant splits ($M)
  const implantBreakdownData = {
    years: ['Q4 2021', 'Q4 2022'],
    initial: [8.5, 9.8],
    replacement: [2.5, 1.4],
    total: [11.0, 12.8]
  };
  const financialMetricsData = [27.6, 80.8, 34.8]; // 2024: Net Loss, Operating Expenses, R&D Expenses ($M)
  const q4RevenueData = {
    years: ['Q4 2021', 'Q4 2022', 'Q4 2023', 'Q4 2024'],
    revenue: [11.0, 12.8, 18.0, 21.5]
  };

  // Color palette (Tailwind CSS compatible)
  const colors = {
    light: {
      primary: '#3b82f6', // blue-500
      secondary: '#10b981', // green-600
      accent: '#ef4444', // red-600
      background: '#ffffff', // white
      text: '#111827', // gray-900 (high contrast)
      grid: '#d1d5db' // gray-300
    },
    dark: {
      primary: '#60a5fa', // blue-400
      secondary: '#34d399', // green-400
      accent: '#f87171', // red-400
      background: '#1f2937', // gray-800
      text: '#e5e7eb', // gray-200
      grid: '#4b5563' // gray-600
    }
  };

  // Determine current mode
  const isDarkMode = () => document.documentElement.classList.contains('dark');
  const getColors = () => isDarkMode() ? colors.dark : colors.light;

  // Base chart configuration
  const chartOptions = {
    responsive: true,
    maintainAspectRatio: true,
    plugins: {
      legend: {
        labels: {
          color: getColors().text,
          font: { size: 14 }
        }
      }
    },
    scales: {
      x: {
        grid: {
          color: getColors().grid
        },
        ticks: {
          color: getColors().text,
          font: { size: 12 }
        }
      },
      y: {
        grid: {
          color: getColors().grid
        },
        ticks: {
          color: getColors().text,
          font: { size: 12 }
        }
      }
    }
  };

  // Store chart instances for updates
  const chartInstances = {};

  // Initialize Revenue Trends Chart
  function initRevenueTrendsChart() {
    const canvas = document.getElementById('neuropace-revenue-trends');
    if (!(canvas instanceof HTMLCanvasElement)) {
      console.error('neuropace-revenue-trends is not a canvas element');
      return;
    }
    canvas.getContext('2d')?.clearRect(0, 0, canvas.width, canvas.height); // Ensure canvas is cleared
    chartInstances.revenueTrends = new Chart(canvas, {
      type: 'line',
      data: {
        labels: years,
        datasets: [{
          label: 'Revenue ($M)',
          data: revenueData,
          borderColor: getColors().primary,
          backgroundColor: getColors().primary + '33',
          fill: true,
          tension: 0.4
        }]
      },
      options: {
        ...chartOptions,
        scales: {
          x: {
            ...chartOptions.scales.x,
            title: { display: true, text: 'Year', color: getColors().text, font: { size: 14 } }
          },
          y: {
            ...chartOptions.scales.y,
            title: { display: true, text: 'Revenue ($M)', color: getColors().text, font: { size: 14 } },
            beginAtZero: true
          }
        }
      }
    });
  }

  // Initialize Q4 Revenue Chart
  function initQ4RevenueChart() {
    const canvas = document.getElementById('neuropace-q4-revenue');
    if (!(canvas instanceof HTMLCanvasElement)) {
      console.error('neuropace-q4-revenue is not a canvas element');
      return;
    }
    canvas.getContext('2d')?.clearRect(0, 0, canvas.width, canvas.height);
    chartInstances.q4Revenue = new Chart(canvas, {
      type: 'bar',
      data: {
        labels: q4RevenueData.years,
        datasets: [{
          label: 'Q4 Revenue ($M)',
          data: q4RevenueData.revenue,
          backgroundColor: getColors().secondary,
          borderColor: getColors().background,
          borderWidth: 1
        }]
      },
      options: {
        ...chartOptions,
        plugins: {
          ...chartOptions.plugins,
          legend: { display: false }
        },
        scales: {
          x: {
            ...chartOptions.scales.x,
            title: { display: true, text: 'Quarter', color: getColors().text, font: { size: 14 } }
          },
          y: {
            ...chartOptions.scales.y,
            title: { display: true, text: 'Revenue ($M)', color: getColors().text, font: { size: 14 } },
            beginAtZero: true
          }
        }
      }
    });
  }

  // Initialize Growth Metrics Chart
  function initGrowthMetricsChart() {
    const canvas = document.getElementById('neuropace-growth-metrics');
    if (!(canvas instanceof HTMLCanvasElement)) {
      console.error('neuropace-growth-metrics is not a canvas element');
      return;
    }
    canvas.getContext('2d')?.clearRect(0, 0, canvas.width, canvas.height);
    chartInstances.growthMetrics = new Chart(canvas, {
      type: 'line',
      data: {
        labels: years.slice(1),
        datasets: [{
          label: 'YoY Growth (%)',
          data: growthRateData.slice(1),
          borderColor: getColors().accent,
          backgroundColor: getColors().accent + '33',
          fill: false,
          tension: 0.4
        }]
      },
      options: {
        ...chartOptions,
        scales: {
          x: {
            ...chartOptions.scales.x,
            title: { display: true, text: 'Year', color: getColors().text, font: { size: 14 } }
          },
          y: {
            ...chartOptions.scales.y,
            title: { display: true, text: 'Growth (%)', color: getColors().text, font: { size: 14 } }
          }
        }
      }
    });
  }

  // Initialize Financial Metrics Chart
  function initFinancialMetricsChart() {
    const canvas = document.getElementById('neuropace-financial-metrics');
    if (!(canvas instanceof HTMLCanvasElement)) {
      console.error('neuropace-financial-metrics is not a canvas element');
      return;
    }
    canvas.getContext('2d')?.clearRect(0, 0, canvas.width, canvas.height);
    chartInstances.financialMetrics = new Chart(canvas, {
      type: 'bar',
      data: {
        labels: ['Net Loss', 'Operating Expenses', 'R&D Expenses'],
        datasets: [{
          label: '2024 Financials ($M)',
          data: financialMetricsData,
          backgroundColor: [getColors().primary, getColors().secondary, getColors().accent],
          borderColor: getColors().background,
          borderWidth: 1
        }]
      },
      options: {
        ...chartOptions,
        plugins: {
          ...chartOptions.plugins,
          legend: { display: false }
        },
        scales: {
          x: {
            ...chartOptions.scales.x,
            title: { display: true, text: 'Metric', color: getColors().text, font: { size: 14 } }
          },
          y: {
            ...chartOptions.scales.y,
            title: { display: true, text: 'Amount ($M)', color: getColors().text, font: { size: 14 } },
            beginAtZero: true
          }
        }
      }
    });
  }

  // Initialize Implant Breakdown Chart
  function initImplantBreakdownChart() {
    const canvas = document.getElementById('neuropace-implant-breakdown');
    if (!(canvas instanceof HTMLCanvasElement)) {
      console.error('neuropace-implant-breakdown is not a canvas element');
      return;
    }
    canvas.getContext('2d')?.clearRect(0, 0, canvas.width, canvas.height);
    chartInstances.implantBreakdown = new Chart(canvas, {
      type: 'bar',
      data: {
        labels: implantBreakdownData.years,
        datasets: [
          {
            label: 'Initial Implants ($M)',
            data: implantBreakdownData.initial,
            backgroundColor: getColors().primary
          },
          {
            label: 'Replacement Implants ($M)',
            data: implantBreakdownData.replacement,
            backgroundColor: getColors().secondary
          }
        ]
      },
      options: {
        ...chartOptions,
        scales: {
          x: {
            ...chartOptions.scales.x,
            title: { display: true, text: 'Period', color: getColors().text, font: { size: 14 } }
          },
          y: {
            ...chartOptions.scales.y,
            title: { display: true, text: 'Revenue ($M)', color: getColors().text, font: { size: 14 } },
            beginAtZero: true
          }
        }
      }
    });
  }

  // Initialize Market Share Pie Chart
  function initMarketSharePieChart() {
    const canvas = document.getElementById('marketSharePieChart');
    if (!(canvas instanceof HTMLCanvasElement)) {
      console.error('marketSharePieChart is not a canvas element');
      return;
    }
    canvas.getContext('2d')?.clearRect(0, 0, canvas.width, canvas.height);
    chartInstances.marketSharePie = new Chart(canvas, {
      type: 'pie',
      data: {
        labels: Object.keys(marketShare2024),
        datasets: [{
          data: Object.values(marketShare2024),
          backgroundColor: [getColors().primary, getColors().secondary, getColors().accent],
          borderColor: getColors().background,
          borderWidth: 1
        }]
      },
      options: {
        ...chartOptions,
        plugins: {
          ...chartOptions.plugins,
          legend: {
            position: 'bottom',
            labels: {
              color: getColors().text,
              font: { size: 12 }
            }
          }
        }
      }
    });
  }

  // Initialize Implant Splits Chart (Mini Chart)
  function initImplantSplitsChart() {
    const canvas = document.getElementById('implantSplitsChart');
    if (!(canvas instanceof HTMLCanvasElement)) {
      console.error('implantSplitsChart is not a canvas element');
      return;
    }
    canvas.getContext('2d')?.clearRect(0, 0, canvas.width, canvas.height);
    chartInstances.implantSplits = new Chart(canvas, {
      type: 'doughnut',
      data: {
        labels: implantSplitsData.labels,
        datasets: [{
          data: implantSplitsData.values,
          backgroundColor: [getColors().primary, getColors().secondary],
          borderColor: getColors().background,
          borderWidth: 1
        }]
      },
      options: {
        ...chartOptions,
        plugins: {
          ...chartOptions.plugins,
          legend: {
            position: 'bottom',
            labels: {
              color: getColors().text,
              font: { size: 12 }
            }
          }
        }
      }
    });
  }

  // Initialize Market Share Mini Chart
  function initMarketShareMiniChart() {
    const canvas = document.getElementById('marketShareMiniChart');
    if (!(canvas instanceof HTMLCanvasElement)) {
      console.error('marketShareMiniChart is not a canvas element');
      return;
    }
    canvas.getContext('2d')?.clearRect(0, 0, canvas.width, canvas.height);
    chartInstances.marketShareMini = new Chart(canvas, {
      type: 'line',
      data: {
        labels: years,
        datasets: [{
          label: 'Market Share (%)',
          data: marketShareData,
          borderColor: getColors().secondary,
          backgroundColor: getColors().secondary + '33',
          fill: true,
          tension: 0.4
        }]
      },
      options: {
        ...chartOptions,
        plugins: {
          ...chartOptions.plugins,
          legend: { display: false }
        },
        scales: {
          x: {
            ...chartOptions.scales.x,
            title: { display: false }
          },
          y: {
            ...chartOptions.scales.y,
            title: { display: false },
            beginAtZero: true
          }
        }
      }
    });
  }

  // Initialize Revenue Mini Chart
  function initRevenueMiniChart() {
    const canvas = document.getElementById('revenueMiniChart');
    if (!(canvas instanceof HTMLCanvasElement)) {
      console.error('revenueMiniChart is not a canvas element');
      return;
    }
    canvas.getContext('2d')?.clearRect(0, 0, canvas.width, canvas.height);
    chartInstances.revenueMini = new Chart(canvas, {
      type: 'line',
      data: {
        labels: years,
        datasets: [{
          label: 'Revenue ($M)',
          data: revenueData,
          borderColor: getColors().primary,
          backgroundColor: getColors().primary + '33',
          fill: true,
          tension: 0.4
        }]
      },
      options: {
        ...chartOptions,
        plugins: {
          ...chartOptions.plugins,
          legend: { display: false }
        },
        scales: {
          x: {
            ...chartOptions.scales.x,
            title: { display: false }
          },
          y: {
            ...chartOptions.scales.y,
            title: { display: false },
            beginAtZero: true
          }
        }
      }
    });
  }

  // Initialize Detailed Chart (Dynamic)
  function initDetailedChart() {
    const canvas = document.createElement('canvas');
    const container = document.getElementById('detailedChartContainer');
    if (!container) {
      console.error('detailedChartContainer not found');
      return;
    }
    container.innerHTML = '';
    container.appendChild(canvas);
    const selector = document.getElementById('chartSelector');
    const description = document.getElementById('chartDescription');
    if (!(selector instanceof HTMLSelectElement) || !description) {
      console.error('chartSelector or chartDescription not found');
      return;
    }

    function updateChart() {
      const value = selector.value;
      let config = {};
      if (value === 'marketShare') {
        config = {
          type: 'line',
          data: {
            labels: years,
            datasets: [{
              label: 'Market Share (%)',
              data: marketShareData,
              borderColor: getColors().secondary,
              backgroundColor: getColors().secondary + '33',
              fill: true,
              tension: 0.4
            }]
          },
          options: {
            ...chartOptions,
            scales: {
              x: {
                ...chartOptions.scales.x,
                title: { display: true, text: 'Year', color: getColors().text, font: { size: 14 } }
              },
              y: {
                ...chartOptions.scales.y,
                title: { display: true, text: 'Market Share (%)', color: getColors().text, font: { size: 14 } },
                beginAtZero: true
              }
            }
          }
        };
        description.textContent = 'This chart shows NeuroPace‚Äôs estimated market share trend from 2018 to 2024. The company has grown from 9.9% in 2018 to 17.7% in 2024.';
      } else if (value === 'revenue') {
        config = {
          type: 'line',
          data: {
            labels: years,
            datasets: [{
              label: 'Revenue ($M)',
              data: revenueData,
              borderColor: getColors().primary,
              backgroundColor: getColors().primary + '33',
              fill: true,
              tension: 0.4
            }]
          },
          options: {
            ...chartOptions,
            scales: {
              x: {
                ...chartOptions.scales.x,
                title: { display: true, text: 'Year', color: getColors().text, font: { size: 14 } }
              },
              y: {
                ...chartOptions.scales.y,
                title: { display: true, text: 'Revenue ($M)', color: getColors().text, font: { size: 14 } },
                beginAtZero: true
              }
            }
          }
        };
        description.textContent = 'This chart shows NeuroPace‚Äôs revenue growth from 2018 to 2024, increasing from $30.0M to $79.9M.';
      } else if (value === 'comparison') {
        config = {
          type: 'bar',
          data: {
            labels: years,
            datasets: [
              {
                label: 'Revenue ($M)',
                data: revenueData,
                backgroundColor: getColors().primary,
                yAxisID: 'y'
              },
              {
                label: 'Market Share (%)',
                data: marketShareData,
                backgroundColor: getColors().secondary,
                yAxisID: 'y1'
              }
            ]
          },
          options: {
            ...chartOptions,
            scales: {
              x: {
                ...chartOptions.scales.x,
                title: { display: true, text: 'Year', color: getColors().text, font: { size: 14 } }
              },
              y: {
                ...chartOptions.scales.y,
                title: { display: true, text: 'Revenue ($M)', color: getColors().text, font: { size: 14 } },
                beginAtZero: true
              },
              y1: {
                ...chartOptions.scales.y,
                position: 'right',
                title: { display: true, text: 'Market Share (%)', color: getColors().text, font: { size: 14 } },
                beginAtZero: true,
                grid: { drawOnChartArea: false }
              }
            }
          }
        };
        description.textContent = 'This chart compares NeuroPace‚Äôs revenue and market share from 2018 to 2024, highlighting growth trends.';
      }
      if (chartInstances.detailedChart) {
        chartInstances.detailedChart.destroy();
      }
      canvas.getContext('2d')?.clearRect(0, 0, canvas.width, canvas.height);
      chartInstances.detailedChart = new Chart(canvas, config);
    }

    selector.addEventListener('change', updateChart);
    updateChart();
  }

  // Dark Mode Toggle
  function initDarkModeToggle() {
    const toggleButton = document.getElementById('darkModeToggle');
    if (!(toggleButton instanceof HTMLButtonElement)) {
      console.error('darkModeToggle not found');
      return;
    }

    const setTheme = (isDark) => {
      document.documentElement.classList.toggle('dark', isDark);
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
      toggleButton.innerHTML = isDark
        ? '<span>‚òÄÔ∏è Light Mode</span>'
        : '<span>üåô Dark Mode</span>';
      Object.values(chartInstances).forEach(chart => {
        if (chart) {
          chart.options.plugins.legend.labels.color = getColors().text;
          chart.options.scales.x.ticks.color = getColors().text;
          chart.options.scales.x.title.color = getColors().text;
          chart.options.scales.y.ticks.color = getColors().text;
          chart.options.scales.y.title.color = getColors().text;
          if (chart.options.scales.y1) {
            chart.options.scales.y1.ticks.color = getColors().text;
            chart.options.scales.y1.title.color = getColors().text;
          }
          chart.data.datasets.forEach((dataset, i) => {
            const colorsArray = [getColors().primary, getColors().secondary, getColors().accent];
            dataset.backgroundColor = dataset.backgroundColor?.includes('33')
              ? colorsArray[i % colorsArray.length] + '33'
              : colorsArray[i % colorsArray.length];
            dataset.borderColor = dataset.backgroundColor?.includes('33')
              ? colorsArray[i % colorsArray.length]
              : getColors().background;
          });
          chart.update();
        }
      });
    };

    const savedTheme = localStorage.getItem('theme');
    setTheme(savedTheme === 'dark');
    toggleButton.addEventListener('click', () => setTheme(!isDarkMode()));
  }

  // Initialize all charts
  initRevenueTrendsChart();
  initQ4RevenueChart();
  initGrowthMetricsChart();
  initFinancialMetricsChart();
  initImplantBreakdownChart();
  initMarketSharePieChart();
  initImplantSplitsChart();
  initMarketShareMiniChart();
  initRevenueMiniChart();
  initDetailedChart();
  initDarkModeToggle();
    }
    </script>
</body>
</html>